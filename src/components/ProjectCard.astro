---
import { localizePath } from "astro-i18next";
import { css } from "../stitches.config";
import Image from "./Image.astro";
import ImageNotFound from "./ImageNotFound.astro";

const { project, useCustomColour } = Astro.props;

const link = css({
    display: "block",
    position: "relative",
    width: "100%",
    height: "100%",
    cursor: "pointer",
});

const imageContainer = css({
    width: "100%",
    height: "100%",
});

const labelContainer = css({
    display: "flex",
    flexDirection: "row",
    alignItems: "baseline",
    gap: "$1",
    position: "absolute",
    bottom: "$space$1",
    insetInline: "$space$1",
    paddingInline: "$2",
    paddingBlock: "$1",
    borderRadius: "$sm",
    background: "rgb($bg / 75%)",
    WebkitBackdropFilter: "blur(25px)",
    backdropFilter: "blur(25px)",

    opacity: 0,
    visibility: "hidden",
    transition:
        "opacity .2s cubic-bezier(.33,1,.68,1),visibility .2s cubic-bezier(.33,1,.68,1)",

    "h2, p": {
        margin: 0,
        fontFamily: "$display",
    },
    h2: {
        fontSize: "1rem",
    },
    p: {
        fontSize: "0.9rem",
    },
});

const card = css({
    display: "flex",
    flexDirection: "column",
    background: "$$cardBg",
    borderRadius: "$md",
    overflow: "hidden",

    [`&:hover .${labelContainer}`]: {
        opacity: 1,
        visibility: "visible",
    },
});
---

<div
    class={card({
        css: useCustomColour
            ? {
                  $$cardBg: `rgb($colors$${project.colour}100) !important`,
              }
            : undefined,
    })}
    role="gridcell"
>
    <a class={link()} href={localizePath(`project/${project.slug}`)}>
        <div class={imageContainer()}>
            {
                project.mainImage ? (
                    <Image
                        src={project.mainImage}
                        width={1333}
                        height={2000}
                        fillContainer
                    />
                ) : (
                    <ImageNotFound />
                )
            }
        </div>
        <div class={labelContainer()}>
            <h2>{project.title}</h2>
            <p>{project.description}</p>
        </div>
    </a>
</div>
