---
import { useSanityClient } from "astro-sanity";
import { projectPathsQuery, projectQuery } from "../../../lib/queries";
import type { Project } from "../../../lib/types";
import ProjectLayout from "../../layouts/project.astro";

export async function getStaticPaths() {
    const projectSlugs: { slug: string; locale: string }[] =
        await useSanityClient().fetch(projectPathsQuery);

    return projectSlugs.map((slug) => ({
        params: slug,
    }));
}

const { slug } = Astro.params;

const { project }: { project: Project } = await useSanityClient().fetch(
    projectQuery,
    {
        slug,
        locale: "en",
    }
);
---

<ProjectLayout project={project}>
    Project: {slug}
</ProjectLayout>
