---
import { useSanityClient } from "astro-sanity";
import i18next from "i18next";

import { homeQuery, projectListQuery } from "../../lib/queries";
import type { Home, Project } from "../../lib/types";

import RotaryDial from "../components/RotaryDial.svelte";
import Footer from "../components/Footer.astro";
import MainLayout from "../layouts/main.astro";
import Nav from "../components/Nav.astro";

const projects: Project[] = await useSanityClient().fetch(projectListQuery, {
    locale: i18next.language,
});
const homepage: Home = await useSanityClient().fetch(homeQuery, {
    locale: i18next.language,
});
---

<MainLayout seo={homepage.seo}>
    <Nav />

    <main>
        <RotaryDial client:only />

        <ul>
            {
                projects.map((p) => (
                    <li>
                        <a href={`/project/${p.slug}`}>{p.title}</a>
                    </li>
                ))
            }
        </ul>

        <Footer />
    </main>
</MainLayout>

<style lang="scss">
    main {
        height: 100vh;
        margin-inline: auto;
        padding-inline: var(--spaces-2);

        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        gap: var(--spaces-6);

        > :global(*) {
            width: 100%;
            max-width: 1024px;
        }
    }
</style>
